# MilesLife_Data_Analyst
<p><strong>Analytics in Practice Project: Data structure, Machine Learning Models and Google Map API, A/B testing.</strong>
<p> 
<p>Thank all my teammates for their commitment to this project!  (last name in alphabetic order):
<p><strong>Pearly Ang, Shujun (Carol) Liu</strong>
<ul>
<li>DataSource: We used data from our client's app (NDA required), thus unable to disclose our raw data.</li>
<li>Code: in Jupyter notebook generated html format.
    <ul>
    <li>Mileslife Final Notebook.html: <strong>Any unauthorized use of API key and plotly account SHALL BE investigated for LEGAL RESPONSIBILITY.</strong></li>
    </ul>
</li>
<li>Final Deliverables: 
<ul>
    <li>Mileslife Final Report.pdf: Project Report</li>
    <li>Mileslife Final Presentation.pdf: Presentation Material.</li>
</ul>
</li>
<p> 
<p>_______________________________________________________________
<p> 
<h4>Introduction to Mileslife</h4>
<p>Mileslife is an innovative loyalty and mileage-earning application available in Hong Kong, Singapore and Shanghai. It is the first platform to give consumers access to easy and direct mileage earning in Asia, and creates highly engaged daily touch points for 16 frequent flyer program partners to be better reach their international clientele; while connecting dining, travel and retail partners with their targeted customer base. Through the Mileslife App, users are able to choose to transact with a partnered retail merchant, and pay directly through Mileslife to earn mileage within 3-5 business days. Mileslife’s business model involves merchant partners need to paying 10% -25% of total price to Mileslife as commission for each transaction. From this commission earned, Mileslife will have to cover immediate costs of 3% credit card transaction fees and purchasing the mileage points accrued by that transaction (HKD$ 0.11 per mile).
<p>Further, Mileslife adopts marketing campaigns in order to attract more customers and increase frequency of app use. Through our lens, these campaign activities can be categorized into: (i) airline-specific campaigns (e.g. bonus miles for a particular airline), (ii) credit-card-specific campaigns, (iii) festival-specific campaigns, and (iv) restaurant-specific campaigns.
<p> 
<h4>Problem Statement and Our Goal</h4>
<p>The first question we sought to answer was assessing the quality of merchant partnerships in the Food & Beverage (F&B) sector through revenue contribution. The initial problem later extended to include the second question on campaign effectiveness when we understood the limitations of the dataset for predictive analytics on the quality of a potential merchant partner and noticed the synergies of understanding how campaigns affect the performance of various partners and the frequency of user transactions. The two questions will be discussed in further detail below:
<ol>
<li>Assessing merchant partnerships in the Food and Beverage (F&B) sector
<p>Our team aims to assess the quality of the Mileslife’s partnership with merchant partners and provide insight to creating a framework to assess future partnerships so as to maximize Mileslife’s user loyalty. In order to do this, we had to consider the impact of merchant-related features such as location, type of cuisine, whether it operated in a chain, and the relationship of those features and the performance of the partner in terms of average revenue.
<p>After the exploratory data analysis, we attempted to build a model to accurately predict the future performance of a potential partner, which creates business value for Mileslife by providing another decision-making apparatus to decide how much commission (as a percentage of the transaction) to negotiate for. The models used were linear regression, decision trees and k-means clustering. However, there were too few variables in the dataset to sufficiently explain the variance in revenue. Even with feature engineering to include only highly relevant features, on normalizing and scaling the dataset, the improvement to the models were minimal, and the overall accuracy was not as ideal. We noticed that campaigns also have a large role to play in the revenue accrued for various partners, and decided to investigate the impact of campaigns on revenue.
<li>Assessing the efficacy of campaigns employed by Mileslife
<p>In order to assess the effectiveness of the campaigns, we decided to consolidate all the same campaigns under its English label for simplicity and analysis, and to conduct A/B testing on the dataset by using a control group (no campaigns) and a treatment group (campaigns) to isolate the effect of the campaign on the income of the restaurant merchant partner and on the commission paid to Mileslife. Further, we planned to analyze the impact of different categories of campaigns on the revenue, and to assess the sensitivity of revenue to changes in the rewards multiplier of campaigns (e.g. 2x Miles Dah Shing Credit Card, 2.5x Miles Dah Shing Credit Card). Finally, we aimed to provide a create heatmaps expressing the effectiveness of these campaigns on different subzone regions of Hong Kong.
</ol>
<p> 
<h4>Data Preprocessing and Exploration</h4>
<ol>
<li>Dataset Characteristics & Pre-processing
<p>Our dataset is Mileslife’s transaction data for Hong Kong in 2018, which contains 25 attributes and about is a subset of 15,200 from 160,000 rows (Mileslife Asia). The dataset describes the restaurants, including name, area, and type of cuisine. It also shows whether this transaction is involved with any campaign activity - if the answer is in the affirmative, it also provides the name of campaign activity. Other important features include variables such as the total price, the total miles customer can get, and the commission Mileslife earns for the transaction.
<p>The dataset was fortified with the exact addressed for each restaurant, by using Google Places API and web-scraping to get the longitude and latitude of each individual restaurant. In addition, we created ‘paid day of week’ and ‘paid hour’ from original variable ‘time paid’, so we could examine whether the paid hour and day of week affects transaction amount and frequency.
<li>Data Visualization
<p>In order to visualize the data to assess the merchant partnerships based on the quantity and magnitude of transactions, we first plotted a chart to determine which type of restaurant is most popular and attractive. It was noticeable that the number of restaurants for different types of cuisine varied widely. In order to avoid bias, we examined the average transaction frequency for each type of restaurant instead of total transaction frequency. As seen in Figure 1 below, Ramen and Chinese cuisines are the most popular types in Hong Kong. The same results were obtained even when we checked across days of week and times of day. Next, we noticed more transactions on Fridays, Saturdays and Sundays, which makes sense as people are more willing to dining out on weekends. As for the hours for payment, it indicated that 1.30 pm and 2.00 pm were the peak hours of usage which are usual times that people would conclude their meals at.
<p>In addition, we analyzed the customer loyalty of a restaurant by using the average transactions of a unique customer in that restaurant. Figure 2 shows that Tuisi & Wine had the highest consistent customer loyalty, where every customer seemed to frequent it at least five times over year. Another finding is that the restaurants with the most customer loyalty are probably the chain stores in the subway station or at the airport - chain stores are highly convenient and airport stores fit into our customer demographics of middle to high income users who are frequent travellers.
​<p>To evaluate and predict the effectiveness of future merchant partnerships, we tried to use linear regression, decision trees and k-means clustering to predict the the performance of a new potential merchant partner with similar attributes. The models and their results are recorded in the code file.
​<ol>
​<p> 
<h4>Analytics on Campaign Effectiveness</h4>
<ol>
<li>How do we evaluate campaign effectiveness? (A/B testing)
<p>After considering the quality of merchant partnerships, we started to analyze Mileslife's campaign effectiveness. As the aim is profit-maximizing, we tried to evaluated campaign performance on profit, which is ​pay commission - (3% * total price + 0.11 * miles)​. However, we received highly negative results with profit as the objective function. After consulting with the client, we realized that the total miles included in the transaction data is equivalent to credit card points. As ‘total miles’ are not actual miles flown on an airline, it may not be appropriate to use this profit formula as our objective function, especially since the actual cost is not estimable - there may be aggressive, high-cost strategies to obtain market share at the app’s inception. Thus, we focused on assessing performance based on revenue, given by the difference in average commission paid in each area. A larger positive difference from a single campaign in a district implies that our campaign works better in that area (denoted by the deep red in the heatmap).
<p>Another consideration is that the number of restaurants in different areas are not the same, and some have more transactions simply due to better reputation and higher ratings than others. In order to isolate the effect of the campaign, we used the A/B testing approach. The control group is the average transactions during non-campaign periods grouped by restaurants. On the other hand, our treatment groups include average transactions during each campaign, similarly grouped by restaurants. We compared the same restaurants across the treatment group and the control group to avoid bias from restaurants' features, and grouped them into the 18 Hong Kong districts to evaluate campaign effectiveness spatially.
<li>In which areas do different kinds of campaigns work best?
<p>Generally, we have 4 types of campaigns as mentioned above: (i) airline-specific campaigns (e.g. bonus miles for a particular airline), (ii) credit-card-specific campaigns, (iii) festival-specific campaigns, and (iv) restaurant-specific campaigns. We picked the campaigns of each type with the highest participation rate for the restaurant partners, and applied our evaluation approach.
<p>However, we faced a problem that not all the campaigns have participation from restaurants in all the 18 districts, and some campaigns show obvious impacts only one or two districts. To solve this, we applied a two-pronged solution: (i) we replaced the NaNs by filling it in with an arbitrarily small value of 0, and (ii) we ordered the zones by sensitivity to campaigns from 0 to 17 (with 17 as the best effect from campaign), to ensure a better visual contrast on the heatmaps.
<p>To illustrate this, we will explore an example. For the “September 3X ANA miles” campaign, which is an airline-specific campaign, we can conclude based on the heatmap (Fig. 3) that this campaign works best in Sha Tin District and Wan Chai District in terms of average difference in commission paid, which are the main commercial districts in Hong Kong in terms of average difference between running the campaign, and a non-campaign period for the amount of commission paid. Yet this is in contrast with transaction density (Fig. 4), where some areas such as Yau Tsim Mong District with extremely high transaction density are not reached by the campaign. Thus, the optimal campaign strategies are not simply about targeting the highest transaction densities, but it should be re-oriented on a case by case basis. In this case, we recommend that Mileslife conducts airline-specific campaigns in Sha Tin District and Wan Chai District in order to maximize revenue.
<p>Similarly, the restaurant-specific campaigns work best in Central and Western District, while the credit card-specific campaigns work best in Sham Shui Po, Yau Tsim Mong, Wan Chai and Central and Western District, and festival-specific campaigns works best in Sai Kung District. There is some overlap with the overall transaction density, except for the festival-specific campaigns. Overall, we would recommend implementing festival-specific campaigns in the future as it has the highest increase in average revenue of 80.33%.
<li> Which area is most sensitive to the bonus miles multiplier?
To assess whether an increase in the multipliers for bonus miles provides significant improvement in the transaction intensity and revenue earnings, we chose two campaigns of the same type and airline (‘2x miles Avios’ and ‘Dah Sing 2.5X Avios’), and did a Difference-in-Difference Analysis on them. Overall, all of the districts react positively to the increase in bonus mile multiplier, but the suburban areas show a larger sensitivity to the an increase in the bonus miles multiplier value. 
<p> 
<h4>Conclusion</h4>
 <p>To sum, for campaign strategies, we should f​ocus on specific districts in different campaigns, implement more festival- specific campaigns and increase the bonus miles multiplier by a greater magnitude for suburban areas where transactions are most sensitive to changes in the multiplier. In assessing the quality of merchant partnerships, we notice that users favor restaurants specializing in Japanese ramen, Shanghai, Yunnan cuisine, according to the Asian palette, and that there is room to reward or continue with existing partners with good customer loyalty such as Tulsi and Wine. It is also noted that while we have the largest number of Western restaurants, they have far lower transaction frequency (total transactions/total number of restaurants).
<p> 
<h4>Limitations and Improvements</h4>
<p>The main limitation in our project lies in the dataset - both in terms of the temporal and inherent aspects. Since Mileslife Hong Kong has had a recent inception in mid-2018, the timeframe the dataset spans is a short one. In addition, the variables inherently did not offer sufficient information to explain the variability in performance across different merchants. This limitation is magnified by the fact that the commission Mileslife receives from transactions with various merchants lies in part in the performance of the merchant, but it too stems from varying cuts (ranging from 10-20%) agreed to in contracts ahead of time. Thus, this made it challenging to assess the quality of merchant partnerships on this metric. This precipitated the introduction of assessing the usefulness of campaigns as an extension to assess how the merchants perform in terms of their customer transaction sensitivity to various campaigns, and allows us to glean more insight into another unexplored, specific area of interest for our client.
<p>The next steps to improve this project to include incorporating Difference-in-Difference analysis to assess the change in revenue for various partners, and thus Mileslife, brought about by the different campaigns. While we were unable to introduce this level of complexity in this project because our data was limited to transactions for one year, we anticipate that Mileslife Hong Kong will have sufficient annualized data to conduct this analysis by end 2019.
